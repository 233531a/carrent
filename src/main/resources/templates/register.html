<th:block th:with="title='–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', active='register'"
          th:replace="~{_fragments/layout :: layout(${title}, ${active}, ~{::content})}">
    <th:block th:fragment="content">
        <div class="auth-container">
            <div class="auth-wrapper auth-wrapper--register">
                <!-- Left side - Visual/Branding -->
                <div class="auth-visual-panel">
                    <div class="auth-visual-content">
                        <div class="auth-logo-large">
                            <div class="logo-icon">üöó</div>
                            <h1 class="logo-text">Rentify</h1>
                        </div>
                        <div class="auth-visual-text">
                            <h2 class="visual-title">–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç</h2>
                            <p class="visual-description">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞–º –∏ –Ω–∞—á–Ω–∏—Ç–µ –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è</p>
                        </div>
                        <div class="auth-features">
                            <div class="feature-item">
                                <span class="feature-icon">‚úì</span>
                                <span>–®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –∞–≤—Ç–æ</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">‚úì</span>
                                <span>–ì–∏–±–∫–∏–µ —É—Å–ª–æ–≤–∏—è</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">‚úì</span>
                                <span>–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
                            </div>
                        </div>
                    </div>
                    <div class="auth-visual-bg">
                        <div class="bg-shape bg-shape-1"></div>
                        <div class="bg-shape bg-shape-2"></div>
                        <div class="bg-shape bg-shape-3"></div>
                    </div>
                </div>

                <!-- Right side - Form -->
                <div class="auth-form-panel">
                    <div class="auth-form-card">
                        <div class="form-header">
                            <h2 class="form-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                            <p class="form-subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞</p>
                        </div>

                        <!-- Alerts -->
                        <div class="alert alert-error" th:if="${error}" th:text="${error}">–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                        <div class="alert alert-success" th:if="${success}" th:text="${success}"></div>

                        <form th:action="@{/register}" method="post" th:object="${form}" class="auth-form" id="registerForm">
                            <input type="hidden" th:name="${_csrf?.parameterName}" th:value="${_csrf?.token}" />

                            <div class="form-group">
                                <label for="username" class="form-label">
                                    <span class="label-icon">üë§</span>
                                    <span>–õ–æ–≥–∏–Ω</span>
                                </label>
                                <div class="input-wrapper">
                                    <input 
                                        type="text" 
                                        id="username" 
                                        name="username" 
                                        class="form-input"
                                        placeholder="–ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞" 
                                        minlength="3" 
                                        maxlength="100" 
                                        required 
                                        th:field="*{username}" />
                                </div>
                                <div class="field-error" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
                            </div>

                            <div class="form-group">
                                <label for="password" class="form-label">
                                    <span class="label-icon">üîí</span>
                                    <span>–ü–∞—Ä–æ–ª—å</span>
                                </label>
                                <div class="input-wrapper input-wrapper-password">
                                    <input 
                                        type="password" 
                                        id="password" 
                                        name="password" 
                                        class="form-input"
                                        placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" 
                                        minlength="6" 
                                        required 
                                        th:field="*{password}" />
                                    <button 
                                        type="button" 
                                        class="password-toggle" 
                                        data-visible="false"
                                        onclick="togglePassword('password', this)" 
                                        aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">
                                        <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                        <svg class="icon-eye-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                            <line x1="1" y1="1" x2="23" y2="23"></line>
                                        </svg>
                                    </button>
                                </div>
                                <div class="field-error" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
                                <div class="field-hint">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤</div>
                            </div>

                            <div class="form-group">
                                <label for="confirmPassword" class="form-label">
                                    <span class="label-icon">üîí</span>
                                    <span>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</span>
                                </label>
                                <div class="input-wrapper input-wrapper-password">
                                    <input 
                                        type="password" 
                                        id="confirmPassword" 
                                        name="confirmPassword" 
                                        class="form-input"
                                        placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" 
                                        minlength="6" 
                                        required 
                                        th:field="*{confirmPassword}" />
                                    <button 
                                        type="button" 
                                        class="password-toggle" 
                                        data-visible="false"
                                        onclick="togglePassword('confirmPassword', this)" 
                                        aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">
                                        <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                        <svg class="icon-eye-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                            <line x1="1" y1="1" x2="23" y2="23"></line>
                                        </svg>
                                    </button>
                                </div>
                                <div class="field-error" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}"></div>
                                <div class="field-hint" id="passwordMatchHint"></div>
                            </div>

                            <button type="submit" class="btn-submit">
                                <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
                                <span class="btn-arrow">‚Üí</span>
                            </button>
                        </form>

                        <div class="form-footer">
                            <p class="footer-text">
                                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? 
                                <a th:href="@{/login}" class="footer-link">–í–æ–π—Ç–∏</a>
                            </p>
                            <p class="footer-security">
                                <span class="security-icon">üîí</span>
                                –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function togglePassword(inputId, button) {
                const input = document.getElementById(inputId);
                const isVisible = input.type === 'password';
                input.type = isVisible ? 'text' : 'password';
                button.setAttribute('data-visible', isVisible);
            }

            (function() {
                const password = document.getElementById('password');
                const confirmPassword = document.getElementById('confirmPassword');
                const hint = document.getElementById('passwordMatchHint');

                if (!password || !confirmPassword || !hint) return;

                function checkMatch() {
                    if (confirmPassword.value.length === 0) {
                        hint.textContent = '';
                        hint.className = 'field-hint';
                        return;
                    }
                    if (password.value === confirmPassword.value) {
                        hint.textContent = '‚úì –ü–∞—Ä–æ–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                        hint.className = 'field-hint success';
                    } else {
                        hint.textContent = '‚úó –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                        hint.className = 'field-hint error';
                    }
                }

                password.addEventListener('input', checkMatch);
                confirmPassword.addEventListener('input', checkMatch);
            })();
        </script>
    </th:block>
</th:block>
