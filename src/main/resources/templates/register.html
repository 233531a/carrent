<th:block th:with="title='–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', active='register'"
          th:replace="~{_fragments/layout :: layout(${title}, ${active}, ~{::content})}">
    <th:block th:fragment="content">
        <!-- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –±—ç–∫–¥—Ä–æ–ø -->
        <div class="auth-backdrop has-spotlight" aria-hidden="true">
            <span class="spotlight" id="authLightReg"></span>
        </div>

        <div class="auth-shell">
            <div class="auth-card">
                <h2 class="page-title auth-title">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</h2>

                <p class="alert alert--warn" th:if="${error}" th:text="${error}">–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>

                <form th:action="@{/register}" method="post" class="form form--auth">
                    <div class="form__grid">
                        <div class="field">
                            <label for="reg_username">–õ–æ–≥–∏–Ω</label>
                            <div class="input-wrap">
                                <input id="reg_username" type="text" name="username" minlength="3" maxlength="100" required/>
                            </div>
                        </div>

                        <div class="field field--password">
                            <label for="regPassword">–ü–∞—Ä–æ–ª—å</label>
                            <div class="input-wrap">
                                <input id="regPassword" type="password" name="password" minlength="6" required/>
                                <button type="button" class="input-eye" onclick="togglePwd('regPassword', this)" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">üëÅ</button>
                            </div>
                        </div>
                    </div>

                    <div class="form__actions">
                        <button class="btn" type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                        <a class="btn btn--light" th:href="@{/login}">–£ –º–µ–Ω—è —É–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç</a>
                    </div>
                </form>
            </div>
        </div>

        <script>
            function togglePwd(id, btn){
                const i = document.getElementById(id);
                if(!i) return;
                const t = i.type === 'password' ? 'text' : 'password';
                i.type = t;
                btn.setAttribute('aria-label', t === 'password' ? '–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å' : '–°–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å');
            }
            (function(){
                const el = document.getElementById('authLightReg');
                if(!el) return;
                let tX = 60, tY = 42, cX = tX, cY = tY, ease = 0.06;
                const loop = () => {
                    cX += (tX - cX)*ease; cY += (tY - cY)*ease;
                    el.style.setProperty('--spot-x', cX + '%');
                    el.style.setProperty('--spot-y', cY + '%');
                    requestAnimationFrame(loop);
                };
                document.addEventListener('mousemove',(e)=>{
                    const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
                    const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
                    tX = (e.clientX / vw) * 100;
                    tY = (e.clientY / vh) * 100;
                });
                loop();
            })();
        </script>
    </th:block>
</th:block>