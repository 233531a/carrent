<th:block th:with="title='–í—Ö–æ–¥', active='login'"
          th:replace="~{_fragments/layout :: layout(${title}, ${active}, ~{::content})}">
    <th:block th:fragment="content">
        <style>
            /* Animated gradient and floating shapes for auth pages */
            .auth-bg-anim { position: absolute; inset: 0; overflow: hidden; pointer-events: none; z-index: 0; }
            .auth-bg-anim .ring { position: absolute; width: 520px; height: 520px; border-radius: 50%; background: radial-gradient(closest-side, rgba(96,165,250,.35), rgba(96,165,250,0)); filter: blur(30px); animation: drift 18s ease-in-out infinite; }
            .auth-bg-anim .ring--violet { background: radial-gradient(closest-side, rgba(167,139,250,.35), rgba(167,139,250,0)); }
            .auth-bg-anim .ring--green { background: radial-gradient(closest-side, rgba(52,211,153,.35), rgba(52,211,153,0)); }
            .auth-bg-anim .ring--1 { left: -140px; top: -120px; animation-delay: 0s; }
            .auth-bg-anim .ring--2 { right: -160px; top: -40px; animation-delay: 4s; }
            .auth-bg-anim .ring--3 { left: 20%; bottom: -160px; animation-delay: 8s; }
            @keyframes drift { 0%,100%{ transform: translate(0,0) scale(1);} 50%{ transform: translate(20px,-30px) scale(1.06);} }
        </style>
        <div class="auth-shell auth-shell--login auth-shell--compact">
            <div class="auth-decoration" style="background: radial-gradient(600px 200px at 90% 0%, rgba(99,102,241,0.25), rgba(99,102,241,0) 60%), radial-gradient(500px 180px at 0% 10%, rgba(59,130,246,0.2), rgba(59,130,246,0) 60%);">
                <div class="auth-decoration__circle auth-decoration__circle--1"></div>
                <div class="auth-decoration__circle auth-decoration__circle--2"></div>
                <div class="auth-decoration__circle auth-decoration__circle--3"></div>
            </div>
            <div class="auth-bg-anim" aria-hidden="true">
                <div class="ring ring--1"></div>
                <div class="ring ring--2 ring--violet"></div>
                <div class="ring ring--3 ring--green"></div>
            </div>
            
            <!-- Form Card -->
            <div class="auth-card">
                <div class="auth-card__header" style="background: linear-gradient(90deg, rgba(96,165,250,0.12), rgba(167,139,250,0.12)); border-radius: 12px;">
                    <div class="auth-icon">üöó</div>
                    <h2 class="page-title auth-title" style="background: linear-gradient(90deg, #60a5fa, #a78bfa); -webkit-background-clip: text; background-clip: text; color: transparent;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
                    <p class="auth-subtitle">–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è</p>
                    <ul class="auth-benefits" aria-label="–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–∞">
                        <li>–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º</li>
                        <li>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –æ–ø–ª–∞—Ç–∞–º–∏</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7</li>
                    </ul>
                </div>

                <p class="alert alert--warn" th:if="${param.error}">–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å.</p>
                <p class="alert alert--success" th:if="${param.logout}">–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.</p>
                <p class="alert alert--success" th:if="${param.registered}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.</p>

                <form th:action="@{/login}" method="post" class="form form--auth">
                    <div class="form__grid">
                        <div class="field">
                            <label for="login_username">
                                <span class="field-icon">üë§</span>
                                –õ–æ–≥–∏–Ω
                            </label>
                            <div class="input-wrap">
                                <input id="login_username" type="text" name="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω" autofocus required/>
                            </div>
                        </div>

                        <div class="field field--password">
                            <label for="loginPassword">
                                <span class="field-icon">üîí</span>
                                –ü–∞—Ä–æ–ª—å
                            </label>
                            <div class="input-wrap">
                                <input id="loginPassword" type="password" name="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required/>
                                <button type="button" class="input-eye" onclick="togglePwd('loginPassword', this)" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="auth-options">
                        <label class="checkbox">
                            <input type="checkbox" name="remember-me"/>
                            <span>–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è</span>
                        </label>
                        <a class="link-muted" th:href="@{/forgot}">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
                    </div>

                    <div class="form__actions">
                        <button class="btn btn--primary" type="submit">
                            <span>–í–æ–π—Ç–∏</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M5 12h14M12 5l7 7-7 7"/>
                            </svg>
                        </button>
                        <a class="btn btn--light" th:href="@{/register}">
                            <span>–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</span>
                        </a>
                    </div>
                </form>
                <div class="auth-extra">
                    <div class="auth-safe">
                        <span class="auth-safe__icon">üîê</span>
                        <span>–ó–∞—â–∏—â—ë–Ω–Ω—ã–π –≤—Ö–æ–¥ –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
                    </div>
                    <div class="auth-links">
                        <a th:href="@{/privacy}">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                        <span>‚Ä¢</span>
                        <a th:href="@{/terms}">–£—Å–ª–æ–≤–∏—è —Å–µ—Ä–≤–∏—Å–∞</a>
                    </div>
                </div>
            </div>

            <!-- Removed car visual; replaced by animated background above -->
        </div>

        <script>
            function togglePwd(id, btn){
                const i = document.getElementById(id);
                if(!i) return;
                const t = i.type === 'password' ? 'text' : 'password';
                i.type = t;
                btn.setAttribute('aria-label', t === 'password' ? '–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å' : '–°–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å');
            }
        </script>
    </th:block>
</th:block>