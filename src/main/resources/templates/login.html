<th:block th:with="title='–í—Ö–æ–¥', active='login'"
          th:replace="~{_fragments/layout :: layout(${title}, ${active}, ~{::content})}">
    <th:block th:fragment="content">
        <div class="auth-shell-simple">
            <div class="auth-card-simple" data-reveal>
                <div class="auth-card__header">
                    <div style="font-size: 2.5rem; margin-bottom: 0.75rem; filter: drop-shadow(0 4px 12px rgba(59, 130, 246, 0.3));">üöó</div>
                    <h1 class="auth-title-simple">–í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç</h1>
                    <p class="auth-subtitle-simple">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ –∞—Ä–µ–Ω–¥—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è</p>
                </div>

                <div class="alert alert--warn" th:if="${param.error}">
                    –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
                </div>

                <div class="alert alert--success" th:if="${param.logout}">
                    –í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.
                </div>

                <div class="alert alert--success" th:if="${param.registered}">
                    –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ.
                </div>

                <div class="alert alert--warn" th:if="${error}" th:text="${error}"></div>

                <form th:action="@{/login}" method="post" class="form-simple" id="loginForm">
                    <input type="hidden" th:name="${_csrf?.parameterName}" th:value="${_csrf?.token}" />

                    <div class="field-simple">
                        <span>üë§ –õ–æ–≥–∏–Ω</span>
                        <input type="text" id="username" name="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" 
                               required autofocus minlength="3" maxlength="100" />
                    </div>

                    <div class="field-simple">
                        <span>üîí –ü–∞—Ä–æ–ª—å</span>
                        <div class="field-simple__pass">
                            <input type="password" id="password" name="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required/>
                            <button type="button" class="pass-toggle" onclick="togglePassword('password', this)" 
                                    aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">üëÅ</button>
                        </div>
                    </div>

                    <div class="auth-row-simple">
                        <label class="checkbox-simple">
                            <input type="checkbox" name="remember-me" />
                            <span>–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è</span>
                        </label>
                    </div>

                    <button type="submit" class="btn-simple btn-simple--primary" style="width: 100%; margin-top: 0.25rem;">
                        –í–æ–π—Ç–∏
                    </button>
                </form>

                <div class="auth-bottom-simple">
                    –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a th:href="@{/register}">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                </div>
            </div>
        </div>

        <script>
            function togglePassword(inputId, button) {
                const input = document.getElementById(inputId);
                if (input.type === 'password') {
                    input.type = 'text';
                    button.textContent = 'üôà';
                } else {
                    input.type = 'password';
                    button.textContent = 'üëÅ';
                }
            }

            (function() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('is-visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll('[data-reveal]').forEach(el => observer.observe(el));
            })();
        </script>
    </th:block>
</th:block>
